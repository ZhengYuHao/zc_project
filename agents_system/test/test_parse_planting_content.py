#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
测试parse_planting_content函数的脚本
"""

import sys
import os
import re
from typing import List, Dict

# 添加项目根目录到Python路径
sys.path.append(os.path.dirname(os.path.abspath(__file__)))

from agents.graphic_outline_agent import parse_planting_content


def test_parse_planting_content():
    """测试parse_planting_content函数"""
    
    # 测试数据 - 从日志中获取的实际数据
    test_content = """图片类型：封面图
图文规划：
特写海信新风空调X3 Pro的凝脂白机身与哑光拉丝面板，空调下方摆放一些绿植，旁边有足球元素（体现FIFA世俱杯定制款），画面整体色调柔和温馨。
海信新风空调X3 Pro，超棒家居好物！
备注：光线充足，空调机身要拍清晰，绿植和足球元素起到点缀作用，突出产品特色与背景。

图片类型：场景图
图文规划：
客厅全景，布置温馨，海信新风空调X3 Pro挂在墙上，与整体家居风格相得益彰，一家人坐在沙发上，宠物在一旁玩耍，画面充满生活气息。
有它，家居生活更美好
备注：画面要展现出和谐舒适的生活氛围，空调外观完整清晰，人物和宠物表情自然。

图片类型：场景图
图文规划：
卧室场景，灯光柔和，海信新风空调X3 Pro在运行，孩子安静地躺在床上睡觉，宠物趴在床边，展示空调安静运行不打扰睡眠的状态。
安静守护每一晚
备注：灯光营造出温馨睡眠氛围，突出空调安静运行，孩子和宠物状态自然。

图片类型：场景图
图文规划：
书房场景，主人在书桌前工作，海信新风空调X3 Pro开启，旁边窗户透进自然光，画面体现空调在日常工作场景中的使用。
工作好伙伴
备注：体现书房的工作氛围，空调与场景融合自然，光线协调。

图片类型：特写图
图文规划：
特写空调的上下双新风口，风口处有绿色灯带亮起，旁边摆放一个小标签注明"60m³/h超大新风量"。
上下双新风口，新风超给力
备注：清晰展示风口细节和灯带，小标签摆放位置合适，突出卖点。

图片类型：特写图
图文规划：
特写空调的凝脂白机身与哑光拉丝面板，用手触摸面板展示不留指纹的特性。
凝脂白机身，指纹不残留
备注：突出机身材质质感，手部动作自然，画面清晰。

图片类型：产品功能展示图
图文规划：
在一个模拟的房间内，开启空调的新风功能，用烟雾模拟污浊空气，展示新风快速净化空气的过程（静态画面捕捉净化瞬间），旁边花字注明"新风五重净化"。
快速净化，清新空气
备注：烟雾效果要自然，能体现出净化的视觉效果，突出功能特点。

图片类型：产品功能展示图
图文规划：
通过手机APP界面展示AI倍省电模式，手机屏幕上显示温度、湿度、能耗值处于平衡状态，空调下方有花字"AI算法，省电41%"。
AI倍省电，舒适又省钱
备注：手机APP界面清晰，与空调画面搭配合理，突出功能。

图片类型：产品功能展示图
图文规划：
展示空调的自然风向摆动算法 + 蝶翼导板，导板处于不同摆动位置，旁边有小球随风摆动，体现风感轻柔。
自然风感，轻柔舒适
备注：清晰展示导板结构和小球摆动状态，突出风感特点。

图片类型：总结图
图文规划：
特写空调，旁边用花字列出核心卖点：增氧新风、AI倍省电、仿真自然风、凝脂白机身 + 哑光拉丝面板 。
海信新风空调X3 Pro，超赞！
备注：空调特写清晰，花字排版合理，突出重点。"""

    print("测试内容:")
    print(test_content)
    print("\n" + "="*50 + "\n")
    
    # 调用解析函数
    result = parse_planting_content(test_content)
    
    print(f"解析结果: 共找到 {len(result)} 个图片信息\n")
    
    for i, data in enumerate(result):
        print(f"图片 {i+1}:")
        print(f"  类型: {data['image_type']}")
        print(f"  规划: {data['planning'][:50]}...")
        print(f"  文案: {data['caption']}")
        print(f"  备注: {data['remark']}")
        print()


if __name__ == "__main__":
    test_parse_planting_content()